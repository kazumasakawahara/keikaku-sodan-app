# 計画相談支援 利用者管理システム

計画相談支援事業所の業務を効率化する、利用者情報管理システムです。

## 📖 このシステムについて

### どんなシステムですか？

このシステムは、**計画相談支援事業所**で働く相談支援専門員の皆様が、日々の業務をより効率的に行えるように開発された、利用者情報の管理システムです。

従来の紙ファイルやExcelでの管理から、Webブラウザで使える統合システムに移行することで、以下のような業務改善が期待できます：

- 📝 利用者情報の一元管理
- 🔍 必要な情報への素早いアクセス
- 📊 支援状況の可視化
- 🤝 スタッフ間での情報共有
- 📄 資料作成の効率化

### 誰が使うシステムですか？

- **相談支援専門員**（3〜4名程度）
- **管理者**（1名）
- 単独の計画相談支援事業所内での利用を想定

### どこで使えますか？

- 事業所内のパソコン（Windows・Mac）
- iPad等のタブレット
- インターネットブラウザがあれば利用可能

---

## 🎯 主な機能

### Phase 1: 基本機能（現在利用可能）✅

#### 1. 利用者基本情報管理
- 氏名、生年月日、連絡先などの基本情報
- 障害者手帳情報（療育手帳・精神障害者保健福祉手帳）
- 障害支援区分
- 成年後見制度の情報
- 情報の登録・修正・削除

#### 2. 相談支援記録管理
- 相談日時・相談形態（訪問・来所・電話など）の記録
- 相談内容と対応の記録
- 担当スタッフの記録
- 過去の相談履歴の確認

#### 3. 関係機関管理
- サービス提供事業所の情報
- 医療機関の情報
- 後見人等の情報
- 各機関の連絡先管理

#### 4. スタッフ管理
- 相談支援専門員の登録
- 利用者の担当スタッフ割り当て
- アクセス権限の管理

### Phase 2: 計画・モニタリング機能（現在利用可能）✅

#### 1. サービス利用計画の管理
- サービス利用計画の作成・編集
- 計画の承認状況管理
- 計画の更新期限管理

#### 2. モニタリング記録
- モニタリングの実施記録
- 実施日・実施場所の記録
- 利用者の状況・変化の記録

#### 3. PDF出力機能
- ケース会議資料の作成
- 家族への交付資料の作成
- 日本語に対応した綺麗な書類出力

#### 4. 服薬情報管理
- 利用者の服薬情報の登録・管理
- 処方医情報の管理
- 服薬履歴の記録
- 現在服用中の薬と過去の服薬情報の区別
- 服薬情報一覧のPDF出力

### Phase 3: 可視化・分析機能（現在利用可能）✅

#### 1. ダッシュボード
- 利用者数の統計
- 計画・モニタリングの実施状況
- 服薬情報の統計（現在服用中の薬、服薬中の利用者数、処方医数）
- 処方医別利用者数ランキング
- アラート機能（更新期限の通知など）
- グラフによる可視化

#### 2. 高度な検索機能
- 複数条件での利用者検索
- 年齢・性別・支援区分などでの絞り込み
- 担当スタッフでの検索

#### 3. ネットワーク図（エコマップ）
- 利用者を中心とした支援体制の可視化
- 関係機関との関係性を図で表示
- PDF出力機能

---

## 🚀 はじめての方へ：システムの起動方法

### ステップ1: 必要なソフトウェアの確認

このシステムを動かすには、以下のソフトウェアが必要です：

1. **Python 3.11以上**
   - プログラムを動かすための基盤となるソフトウェア
   - お使いのパソコンにインストールされているか確認してください

2. **uv（パッケージマネージャー）**
   - Pythonのパッケージを管理するツール
   - 下記の方法でインストールできます

### ステップ2: uvのインストール

**Macをお使いの方：**
```bash
# ターミナル（アプリケーション → ユーティリティ → ターミナル）を開いて、
# 以下のコマンドを入力してください

curl -LsSf https://astral.sh/uv/install.sh | sh

# または、Homebrewをお使いの場合
brew install uv
```

**Windowsをお使いの方：**
PowerShellを開いて、上記のインストール用URLからインストーラーをダウンロードしてください。

### ステップ3: プロジェクトのダウンロード

#### 方法A: Gitを使う場合（推奨）

```bash
# GitHubからプロジェクトをダウンロード
git clone https://github.com/kazumasakawahara/keikaku-sodan-app.git

# プロジェクトフォルダに移動
cd keikaku-sodan-app
```

#### 方法B: Gitがない場合

1. ブラウザで以下のURLにアクセス：
   ```
   https://github.com/kazumasakawahara/keikaku-sodan-app
   ```
2. 緑色の「**Code**」ボタンをクリック
3. 「**Download ZIP**」を選択
4. ダウンロードしたZIPファイルを解凍
5. ターミナル（またはコマンドプロンプト）で解凍したフォルダに移動：
   ```bash
   cd keikaku-sodan-app-main
   ```

### ステップ4: システムのセットアップ

```bash
# 1. 仮想環境を作成（初回のみ）
uv venv

# 2. 仮想環境を有効化
# Macの場合：
source .venv/bin/activate

# Windowsの場合：
.venv\Scripts\activate

# 3. 必要なソフトウェアをインストール（初回のみ）
uv sync

# 4. データベースの初期化（初回のみ）
python scripts/init_db.py

# 5. テストデータの投入（初回のみ・任意）
python scripts/seed_data.py
```

### ステップ5: システムの起動

```bash
# シンプルな起動方法
./scripts/start.sh

# または、手動で起動する場合
uv run uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### ステップ6: ブラウザでアクセス

システムが起動したら、お使いのブラウザ（Chrome、Safari、Edgeなど）で以下のアドレスにアクセスしてください：

```
http://localhost:8000
```

### ステップ7: ログイン

**初期アカウント情報：**
- ユーザー名: `admin`
- パスワード: `admin123`

> ⚠️ **重要**: 初回ログイン後は、必ずパスワードを変更してください。

---

## 📖 使い方ガイド

### 利用者情報の登録

1. ログイン後、画面上部のナビゲーションから「利用者一覧」をクリック
2. 「新規利用者登録」ボタンをクリック
3. 必要な情報を入力して「登録」ボタンをクリック

### 相談記録の追加

1. 利用者一覧から該当する利用者をクリック
2. 「新規記録」ボタンをクリック
3. 相談日時、内容、対応などを入力して保存

### PDF資料の出力

1. 利用者詳細ページで「PDF出力」ボタンをクリック
2. 自動的にPDFファイルがダウンロードされます
3. ダウンロードしたPDFは印刷や保存が可能です

### ネットワーク図の表示

1. 利用者詳細ページで「ネットワーク図」ボタンをクリック
2. 利用者を中心とした関係機関が図で表示されます
3. 必要に応じてPDF出力も可能です

### 服薬情報の管理

#### 服薬情報の登録
1. 利用者詳細ページで「服薬情報」タブをクリック
2. 「新規登録」ボタンをクリック
3. 薬品名、用量、服用回数、タイミングなどを入力
4. 「処方医を選択」で処方医を選ぶ（新規登録も可能）
5. 「登録」ボタンをクリック

#### 処方医の管理
1. 服薬情報タブで「処方医管理」ボタンをクリック
2. 登録済みの処方医一覧が表示されます
3. 「新規処方医登録」で医師情報を追加できます
   - 医師名、医療機関名、診療科、連絡先を入力

#### 服薬情報のPDF出力
1. 服薬情報タブで「PDF出力」ボタンをクリック
2. 現在服用中の薬と過去の服薬履歴が含まれたPDFが生成されます
3. 自動的にダウンロードされます

**活用例:**
- ケース会議での情報共有
- 医療機関への情報提供
- 家族への服薬状況の説明資料

### CSVデータの出力

1. 利用者一覧画面で「CSV出力」ボタンをクリック
2. Excel形式のCSVファイルがダウンロードされます
3. ダウンロードフォルダに保存されます
   - Mac: Finder → ダウンロード
   - Windows: エクスプローラー → ダウンロード
4. Excelで開いて編集・分析が可能です

**活用例:**
- データのバックアップとして保存
- Excelで独自の集計・分析
- 他のシステムへのデータ移行

---

## 🔒 セキュリティについて

### データの安全性

- すべてのデータは事業所内のサーバーに保管されます
- インターネット上には保存されません
- パスワードは暗号化されて保存されます

### アクセス制限

- ログインしたユーザーのみがシステムを使用できます
- 管理者と一般ユーザーで権限を分けることができます

### バックアップ

定期的なバックアップを推奨します：

```bash
# バックアップの実行
./scripts/backup.sh
```

バックアップファイルは `backups/` フォルダに保存されます。

---

## 🆘 困った時は

### よくある質問

**Q1: システムにログインできません**

A: 以下を確認してください：
- ユーザー名とパスワードが正しいか
- Caps Lock（大文字固定）がOFFになっているか
- ブラウザのキャッシュをクリアしてみる

**Q2: データが表示されません**

A: 以下を試してください：
1. ページを再読み込み（F5キーまたは更新ボタン）
2. ブラウザを再起動
3. システムを再起動

**Q3: PDFが文字化けします**

A: 日本語フォントが正しくインストールされているか確認してください。

**Q4: 服薬情報が表示されません**

A: 以下を確認してください：
1. 利用者詳細ページで「服薬情報」タブが選択されているか
2. データベースに服薬情報が登録されているか確認
3. ブラウザの開発者ツール（F12キー）でエラーメッセージを確認

**Q5: 服薬情報PDFの出力に失敗します**

A: 以下をお試しください：
1. ブラウザで再度ログインし直す
2. 利用者に服薬情報が登録されているか確認
3. ブラウザのポップアップブロックが有効になっていないか確認
4. それでも解決しない場合は、システム管理者に連絡してください

**Q6: ダッシュボードに服薬統計が表示されません**

A: 以下を確認してください：
1. システムに服薬情報が登録されているか確認
2. ページを再読み込み（F5キー）してみる
3. データベースが正しく動作しているか確認

### システムの再起動方法

```bash
# 1. 実行中のシステムを停止（Ctrl + C を押す）

# 2. 再度起動
./scripts/start.sh
```

### エラーが発生した場合

エラーメッセージが表示された場合は：
1. エラーメッセージをスクリーンショットで保存
2. どの操作をしていたか記録
3. システム管理者に連絡

---

## 📚 詳細ドキュメント

さらに詳しい情報は、以下のドキュメントをご覧ください：

- **[DEPLOYMENT.md](./DEPLOYMENT.md)**: 本番環境へのデプロイ手順
  - サーバーへのインストール方法
  - 自動起動の設定
  - バックアップの自動化

- **[HANDOVER.md](./HANDOVER.md)**: システムの詳細仕様
  - 機能の詳細説明
  - データベース設計
  - 画面構成

- **[CLAUDE.md](./CLAUDE.md)**: 開発者向け情報
  - 技術スタック
  - 開発環境のセットアップ

---

## 🛠️ 使用している技術

このシステムは以下の技術で作られています：

- **プログラミング言語**: Python
- **Webフレームワーク**: FastAPI
- **データベース**: SQLite（ファイルベース）
- **画面デザイン**: Bootstrap 5
- **PDF生成**: ReportLab
- **グラフ表示**: Chart.js、D3.js

---

## 📞 お問い合わせ

システムに関するご質問や改善のご要望がありましたら、事業所内のシステム管理担当者にご連絡ください。

---

## 📝 バージョン情報

- **現在のバージョン**: 1.1.0
- **最終更新日**: 2025年10月25日
- **実装状況**: Phase 1〜3 完了
- **最新の機能追加**:
  - 服薬情報管理機能（Phase 2）
  - 処方医管理機能（Phase 2）
  - 服薬情報PDF出力（Phase 2）
  - ダッシュボード服薬統計表示（Phase 3）

---

## 🙏 謝辞

このシステムは、計画相談支援の現場で働く相談支援専門員の皆様の業務効率化と、利用者へのより良い支援の実現を目指して開発されました。

日々、利用者の方々に寄り添い、丁寧な支援を行っている皆様の業務に、少しでもお役に立てれば幸いです。
